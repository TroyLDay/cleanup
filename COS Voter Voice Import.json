{
  "Name": "COS Voter Voice Import",
  "CreationDate": "2019-11-30",
  "Commands": [
    {
      "Command": "store",
      "Target": "1",
      "Value": "ACOUNTER"
    },
    {
      "Command": "csvRead",
      "Target": "userchanges.csv",
      "Value": ""
    },
    {
      "Command": "comment",
      "Target": "open // https://dashboard.conventionofstates.com",
      "Value": ""
    },
    {
      "Command": "open",
      "Target": "https://dashboard.conventionofstates.com/admin/people?filter_slug=YatqLqhqK-UxUF-7U3gs",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "tab=open",
      "Value": "https://dashboard.conventionofstates.com/admin/people?filter_slug=SKNpTgHyG4SjUfMpRoZ2"
    },
    {
      "Command": "selectWindow",
      "Target": "tab=open",
      "Value": "https://dashboard.conventionofstates.com/admin/people?filter_slug=dE83jKqkDw_xJ-EPGVKj"
    },
    {
      "Command": "while_v2",
      "Target": "${!csvReadStatus} == \"OK\"",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!csvReadLineNumber}>1",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!COL1}!=='NoID'",
      "Value": ""
    },
    {
      "Command": "comment",
      "Target": "Find by NB ID",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "tab=0",
      "Value": ""
    },
    {
      "Command": "waitForVisible",
      "Target": "id=per_page",
      "Value": ""
    },
    {
      "Command": "type",
      "Target": "id=criteria_13_1_person_category_id_value",
      "Value": "${!COL1}"
    },
    {
      "Command": "elseif",
      "Target": "${!COL6}!==''",
      "Value": ""
    },
    {
      "Command": "comment",
      "Target": "Find by email",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "tab=1",
      "Value": ""
    },
    {
      "Command": "waitForVisible",
      "Target": "id=per_page",
      "Value": ""
    },
    {
      "Command": "type",
      "Target": "id=criteria_12_1_email_category_email_value",
      "Value": "${!COL6}"
    },
    {
      "Command": "else",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "comment",
      "Target": "Find by Name",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "tab=2",
      "Value": ""
    },
    {
      "Command": "waitForVisible",
      "Target": "id=per_page",
      "Value": ""
    },
    {
      "Command": "type",
      "Target": "id=criteria_14_1_person_category_first_name_value",
      "Value": "${!COL3}"
    },
    {
      "Command": "type",
      "Target": "id=criteria_15_1_person_category_last_name_value",
      "Value": "${!COL4}"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "xpath=//*[@id=\"filter-form\"]/div[2]/button[3]",
      "Value": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/aside[3]/div/div/div[2]/div[1]/div/span",
      "Value": "NUM_RESULTS"
    },
    {
      "Command": "if_v2",
      "Target": "${NUM_RESULTS}==='1'",
      "Value": ""
    },
    {
      "Command": "storeAttribute",
      "Target": "/html/body/main/div/ul/li[${ACOUNTER}]/div[2]/header/div/h1/a@href",
      "Value": "PROFILE"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/main/div/ul/li/div[2]/p/span[1]",
      "Value": "EX_ADDRESS"
    },
    {
      "Command": "executeScript",
      "Target": "return ${EX_ADDRESS}.split(',')[0].trim()",
      "Value": "EX_ADDRESS_STREET"
    },
    {
      "Command": "executeScript",
      "Target": "return ${EX_ADDRESS}.split(',')[1].trim()",
      "Value": "EX_ADDRESS_CITY"
    },
    {
      "Command": "executeScript",
      "Target": "return ${EX_ADDRESS}.split(',')[2].trim()",
      "Value": "EX_ADDRESS_STATE"
    },
    {
      "Command": "executeScript",
      "Target": "return ${EX_ADDRESS}.split(',')[3].trim()",
      "Value": "EX_ADDRESS_ZIP"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/main/div/ul/li/div[2]/ul[2]/li",
      "Value": "EX_EMAIL"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/main/div/ul/li/div[2]/ul[1]/li/span[1]",
      "Value": "EX_PHONE_TYPE"
    },
    {
      "Command": "if_v2",
      "Target": "${EX_PHONE_TYPE}==='home phone:'",
      "Value": "EX_PHONE_TYPE"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/main/div/ul/li/div[2]/ul[1]/li/span[2]",
      "Value": "EX_PHONE_HOME"
    },
    {
      "Command": "else",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/main/div/ul/li/div[2]/ul[1]/li/span[2]",
      "Value": "EX_PHONE_MOBILE"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "comment",
      "Target": "run // COS People address",
      "Value": ""
    },
    {
      "Command": "elseif",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "echo",
      "Target": "",
      "Value": "More than one result, must decide which to update."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${!csvReadLineNumber})+1",
      "Value": "!csvReadLineNumber"
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!errorIgnore"
    },
    {
      "Command": "comment",
      "Target": "echo // Reading CSV line No.  ${!csvReadLineNumber} ",
      "Value": "!errorIgnore"
    },
    {
      "Command": "csvRead",
      "Target": "userchanges.csv",
      "Value": ""
    },
    {
      "Command": "store",
      "Target": "false",
      "Value": "!errorIgnore"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    }
  ]
}