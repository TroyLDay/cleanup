{
  "Name": "COS Petition need_review",
  "CreationDate": "2019-10-15",
  "Commands": [
    {
      "Command": "store",
      "Target": "false",
      "Value": "USE_PROFILE"
    },
    {
      "Command": "selectWindow",
      "Target": "title=${TASK_TYPE} - COS",
      "Value": ""
    },
    {
      "Command": "storeAttribute",
      "Target": "//table[@id=\"DataTables_Table_0\"]/tbody/tr[${ACOUNTER}+1]/td[10]/ul/li/a@href",
      "Value": "PETITION"
    },
    {
      "Command": "selectWindow",
      "Target": "tab=open",
      "Value": "https://dashboard.conventionofstates.com${PETITION}"
    },
    {
      "Command": "label",
      "Target": "RESTART",
      "Value": ""
    },
    {
      "Command": "executeScript",
      "Target": "window.cleanUp={ \tprofileChecked:function(addrElem,tagElem){ \t\tvar addr=addrElem.textContent.split(', '); \t\tvar tagText=tagElem?tagElem.textContent:''; \t\tvar tag=false; \t\tvar zip=false;  \t\tif(tagText.indexOf('Macro Skip')>-1){ \t\t\treturn 'Macro Skip'; \t\t}else{ \t\t\tif(tagText.indexOf('Districts Confirmed Manually')>-1){ \t\t\t  tag=true; \t\t\t} \t\t\tif(tagText.indexOf('Districts Based On 5 Digit Zip Code')>-1){ \t\t\t  tag=true; \t\t\t} \t\t\tif(addr[addr.length-1].length===10) { \t\t\t  zip=true; \t\t\t} \t\t\tif(tag||zip) { \t\t\t  if(tagElem){ \t\t\t\ttagElem.style.backgroundColor=tag?'green':'white'; \t\t\t  } \t\t\t  addrElem.style.backgroundColor=zip?'green':'white'; \t\t\t}else{ \t\t\t  if(tagElem){ \t\t\t\ttagElem.style.backgroundColor='red'; \t\t\t  } \t\t\t  addrElem.style.backgroundColor='red'; \t\t\t} \t\t\treturn tag||zip; \t\t} \t} };",
      "Value": ""
    },
    {
      "Command": "executeScript",
      "Target": "return window.cleanUp.profileChecked(window.document.querySelector('#petition > div.contact-info-wrap > ul > li:nth-child(1) > span.contact-value'),window.document.querySelector('#petition > div.tags-wrap > ul'));",
      "Value": "SENDABLE"
    },
    {
      "Command": "gotoIf_v2",
      "Target": "${SENDABLE}==='Macro Skip'",
      "Value": "DONE"
    },
    {
      "Command": "if_v2",
      "Target": "!${SENDABLE}",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "COS People address",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ANSWER}!==null",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "title=Check Petitions - COS",
      "Value": ""
    },
    {
      "Command": "storeEval",
      "Target": "window.location.reload();",
      "Value": ""
    },
    {
      "Command": "executeScript",
      "Target": "window.location.reload();",
      "Value": ""
    },
    {
      "Command": "pause",
      "Target": "2000",
      "Value": ""
    },
    {
      "Command": "executeScript",
      "Target": "return window.document.querySelector('#form_handler_petition_review > ul.petition-input-wrap.controls-wrap > li:nth-child(1) > button');",
      "Value": "SEND_BUTTON"
    },
    {
      "Command": "gotoIf_v2",
      "Target": "${SEND_BUTTON}===null",
      "Value": "DONE"
    },
    {
      "Command": "gotoLabel",
      "Target": "RESTART",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ANSWER}!==null",
      "Value": ""
    },
    {
      "Command": "executeScript",
      "Target": "window.document.querySelector('#petition > div.tags-wrap > ul')?window.document.querySelector('#petition > div.tags-wrap > ul').scrollIntoView():null;",
      "Value": ""
    },
    {
      "Command": "prompt",
      "Target": "Click Confirm to Send email to Legislator and continue.\\nClick Cancel to stop automation.",
      "Value": "ANSWER"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ANSWER}!==null",
      "Value": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "name=button",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "label",
      "Target": "DONE",
      "Value": ""
    },
    {
      "Command": "selectWindow",
      "Target": "tab=close",
      "Value": ""
    }
  ]
}